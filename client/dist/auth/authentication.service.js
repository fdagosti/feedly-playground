"use strict";var __decorate=this&&this.__decorate||function(e,t,o,r){var n,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(i=(a<3?n(i):a>3?n(t,o,i):n(t,o))||i);return a>3&&i&&Object.defineProperty(t,o,i),i},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),http_1=require("@angular/http");require("rxjs/add/operator/toPromise");var FeedlyToken=function(){function e(e,t){this.fullName=e,this.token=t}return e}(),AuthService=function(){function e(e){this._http=e,this.loginStateChanged$=new core_1.EventEmitter}return e.prototype.login=function(t){var o=this,r={headers:new http_1.Headers({Authorization:"OAuth "+t})};return this._http.get(e.PROXY+e.ENDPOINT+"profile",r).toPromise().then(function(e){return o.saveToken(e.json(),t),o.loginStateChanged$.emit("login"),o.currentUser()})["catch"](this.handleError)},e.prototype.saveToken=function(e,t){var o={fullName:e.fullName,token:t};window.localStorage["feedly-playground-token"]=JSON.stringify(o)},e.prototype.getToken=function(){var e=window.localStorage["feedly-playground-token"];if(e)return JSON.parse(e)},e.prototype.isLoggedIn=function(){var e=this.getToken();return void 0!=e},e.prototype.logout=function(){window.localStorage.removeItem("feedly-playground-token"),this.loginStateChanged$.emit("logout")},e.prototype.handleError=function(e){return Promise.reject(e.json())},e.prototype.currentUser=function(){var e=this.getToken();if(e)return{fullName:e.fullName}},e.PROXY="https://cisco-itk-proxy.herokuapp.com/",e.ENDPOINT="https://cloud.feedly.com/v3/",e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[http_1.Http])],e)}();exports.AuthService=AuthService;